import numpy as np

r0 = 2.3
latent_period = 2.5
inf_period_presymp = 1
inf_period_mild = 6
inf_period_severe = 6
p_severe = np.array([ 0.01105917873099,0.01105917873099,0.01105917873099,0.0270580925139558,0.0270580925139558,0.0270580925139558,0.0270580925139558,0.0270580925139558,0.0270580925139558,0.0270580925139558,0.117957714542174,0.117957714542174,0.117957714542174,0.117957714542174,0.353784903790709,0.353784903790709,0.0236720096464102,0.0236720096464102,0.0236720096464102,0.0579174496211877,0.0579174496211877,0.0579174496211877,0.0579174496211877,0.0579174496211877,0.0579174496211877,0.0579174496211877,0.252486755520668,0.252486755520668,0.252486755520668,0.252486755520668,0.757271390489436,0.757271390489436 ])
p_icu = np.array([ 0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26,0.26 ])
hosp_dur = 10
icu_a_dur = 3
icu_b_dur = 21
icu_c_dur = 21
cfr_icu = np.array([ 0,0,0,0.198624847085978,0.198624847085978,0.198624847085978,0.198624847085978,0.198624847085978,0.198624847085978,0.198624847085978,0.357746732290146,0.357746732290146,0.357746732290146,0.357746732290146,0.57517641084824,0.57517641084824,0,0,0,0.526355844777842,0.526355844777842,0.526355844777842,0.526355844777842,0.526355844777842,0.526355844777842,0.526355844777842,0.904784579342181,0.904784579342181,0.904784579342181,0.904784579342181,1,1 ])
p_quarantine_s = 0
p_quarantine_s_interv = 0
p_quarantine_e = 0.1
p_quarantine_e_interv = 0.1
quarantine_dur = 14
rr_isolate = 0.1
rr_isolate_interv = 0.1
time_to_detect        = np.array([56.9473294861794, 56.9473294861794, 56.9473294861794, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 56.9473294861794, 56.9473294861794, 56.9473294861794, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522 ])
time_to_detect_interv = np.array([56.9473294861794, 56.9473294861794, 56.9473294861794, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 56.9473294861794, 56.9473294861794, 56.9473294861794, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 11.7456911338273, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522, 4.98350127049522])
rr_contact = 1
rr_contact_interv = np.ones((32, 32))
beta = 0.0282218197632275

cm = np.array([[1.493025873,0.64037891,0.35781597,0.2344606,0.4565411,0.8167983,0.7722663,0.7579513,0.2860238,0.1905693,0.2796415,0.1889373,0.1394730,0.07889112,0.04223719,0.005146106,0.17889486,0.07673108,0.04287382,0.03534461,0.07555822,0.09889437,0.11641756,0.15634464,0.06928514,0.07633458,0.1215659,0.11433266,0.1345409,0.09839225,0.07009568,0.01025793],
[0.610375950,5.26640553,0.94503982,0.4534684,0.4581556,0.7454635,0.9501127,0.9912628,0.7143301,0.2518750,0.2730039,0.1586324,0.2193032,0.12553974,0.03175208,0.074701817,0.07313545,0.63102792,0.11323548,0.06835972,0.07582544,0.09025747,0.14322754,0.20447043,0.17303617,0.10089127,0.1186804,0.09599406,0.2115482,0.15657196,0.05269488,0.14890597],
[0.330742025,0.91647238,5.21480902,1.0196465,0.2317560,0.3823829,0.4983472,0.7742797,0.7707635,0.4492450,0.2779045,0.2498825,0.1292486,0.10746764,0.07450471,0.045625728,0.03962962,0.10981298,0.62484288,0.15371029,0.03835596,0.04629726,0.07512482,0.15971273,0.18670634,0.17994992,0.1208108,0.15121276,0.1246781,0.13403261,0.12364595,0.09094750],
[0.203667678,0.41327472,0.95823542,5.2533288,1.1708064,0.7403974,0.4067318,0.6163523,0.6377917,0.6774381,0.4136637,0.2206506,0.1243500,0.14009301,0.10223429,0.090627800,0.02440353,0.04951914,0.11481659,0.79193200,0.19377020,0.08964409,0.06131399,0.12713664,0.15449586,0.27135513,0.1798281,0.13352346,0.1199528,0.17472266,0.16966519,0.18065184],
[0.334246628,0.35191666,0.18356440,0.9867793,2.4403731,1.4053916,0.7324484,0.5358395,0.5407472,0.6473556,0.4959939,0.3529667,0.1929852,0.11730760,0.06695984,0.055097430,0.04004954,0.04216714,0.02199484,0.14875561,0.40388537,0.17015868,0.11041509,0.11052904,0.13098823,0.25930527,0.2156187,0.21359266,0.1861608,0.14630492,0.11112470,0.10982780],
[0.566924434,0.54284562,0.28713042,0.5915930,1.3323567,1.8903254,0.9841461,0.6502246,0.5897872,0.6413355,0.6698722,0.5045711,0.2824546,0.19973879,0.07630376,0.039633379,0.06792908,0.06504450,0.03440421,0.08918182,0.22050702,0.22887235,0.14835800,0.13412357,0.14286744,0.25689384,0.2912072,0.30533385,0.2724665,0.24911231,0.12663161,0.07900272],
[0.572321060,0.73873282,0.39955359,0.3469993,0.7414169,1.0508043,1.4516272,0.8931970,0.6388846,0.5006455,0.5542924,0.4429358,0.3058252,0.14354522,0.03962774,0.088090608,0.06857570,0.08851598,0.04787485,0.05230966,0.12270560,0.12722681,0.21882983,0.18424213,0.15476058,0.20053894,0.2409623,0.26803612,0.2950106,0.17902823,0.06576510,0.17559436],
[0.615553677,0.84460384,0.68028799,0.5762374,0.5943909,0.7608126,0.9788118,1.0589027,0.8317396,0.6019318,0.4968165,0.3874888,0.3354414,0.22644748,0.06024460,0.101184617,0.07375585,0.10120159,0.08151269,0.08686698,0.09837257,0.09211587,0.14755388,0.21842268,0.20147693,0.24111030,0.2159763,0.23448316,0.3235795,0.28242314,0.09998026,0.20169514],
[0.252515393,0.66164385,0.73616842,0.6482050,0.6520679,0.7501890,0.7610890,0.9041667,0.8873070,0.8411359,0.5553286,0.3907147,0.3471006,0.18525041,0.14261889,0.139546602,0.03025648,0.07927907,0.08820833,0.09771600,0.10791821,0.09082961,0.11473261,0.18650488,0.21493733,0.33692606,0.2414128,0.23643530,0.3348265,0.23104255,0.23668636,0.27816354],
[0.184448440,0.25576837,0.47040902,0.7548132,0.8558109,0.8943283,0.6538524,0.7173726,0.9221520,1.3054786,0.5912371,0.4545134,0.3223908,0.14018838,0.13792450,0.106906719,0.02210067,0.03064652,0.05636481,0.11378703,0.14163797,0.10828137,0.09856690,0.14797436,0.22337804,0.52292353,0.2570229,0.27504217,0.3109904,0.17484162,0.22889568,0.21310122],
[0.263169434,0.26955179,0.28294353,0.4481558,0.6375627,0.9082710,0.7038824,0.5757119,0.5919679,0.5748750,0.5873438,0.6907726,0.2906952,0.16631171,0.12118327,0.249819172,0.03153305,0.03229806,0.03390254,0.06755886,0.10551758,0.10996949,0.10610882,0.11875363,0.14339568,0.23027236,0.2553304,0.41801093,0.2804156,0.20742238,0.20111240,0.49797404],
[0.184652457,0.16265550,0.26420653,0.2482505,0.4711768,0.7104759,0.5841245,0.4663069,0.4325251,0.4589464,0.7173624,0.8233735,0.4604958,0.23002060,0.08620207,0.148566505,0.02212512,0.01948960,0.03165745,0.03742342,0.07798046,0.08602133,0.08805557,0.09618636,0.10477298,0.18383593,0.3118522,0.49825244,0.4442117,0.28687949,0.14305857,0.29614326],
[0.190027122,0.31348022,0.19051176,0.1950380,0.3591387,0.5544518,0.5622456,0.5627527,0.5356674,0.4538226,0.4208521,0.6419687,0.4116685,0.29157652,0.12946792,0.216110047,0.02276911,0.03756163,0.02282728,0.02940170,0.05943799,0.06713061,0.08475738,0.11608050,0.12975770,0.18178352,0.1829531,0.38847797,0.3971111,0.36365145,0.21486137,0.43078036],
[0.148068445,0.24720384,0.21821391,0.3026904,0.3007276,0.5401153,0.3635385,0.5233320,0.3938291,0.2718469,0.3316831,0.4417370,0.4016626,0.37237151,0.22243779,0.066391124,0.01774161,0.02962030,0.02614658,0.04563015,0.04977087,0.06539480,0.05480269,0.10794909,0.09539943,0.10889120,0.1441895,0.26731070,0.3874590,0.46441820,0.36915159,0.13233995],
[0.113362547,0.08941006,0.21633590,0.3158776,0.2454719,0.2950599,0.1435163,0.1990985,0.4335766,0.3824669,0.3456077,0.2367309,0.2550417,0.31808905,0.25193490,0.186374346,0.01358314,0.01071324,0.02592155,0.04761811,0.04062596,0.03572456,0.02163479,0.04106858,0.10502769,0.15320125,0.1502428,0.14325424,0.2460229,0.39671763,0.41810418,0.37150706],
[0.009216882,0.14037057,0.08840675,0.1868592,0.1347874,0.1022718,0.2128934,0.2231491,0.2830993,0.1978282,0.4754417,0.2722632,0.2840892,0.06335500,0.12437036,0.279360053,0.00110437,0.01681939,0.01059297,0.02816876,0.02230752,0.01238263,0.03209325,0.04602956,0.06857673,0.07924222,0.2066843,0.16475607,0.2740432,0.07901576,0.20640160,0.55685900],
[1.493025873,0.64037891,0.35781597,0.2344606,0.4565411,0.8167983,0.7722663,0.7579513,0.2860238,0.1905693,0.2796415,0.1889373,0.1394730,0.07889112,0.04223719,0.005146106,0.17889486,0.07673108,0.04287382,0.03534461,0.07555822,0.09889437,0.11641756,0.15634464,0.06928514,0.07633458,0.1215659,0.11433266,0.1345409,0.09839225,0.07009568,0.01025793],
[0.610375950,5.26640553,0.94503982,0.4534684,0.4581556,0.7454635,0.9501127,0.9912628,0.7143301,0.2518750,0.2730039,0.1586324,0.2193032,0.12553974,0.03175208,0.074701817,0.07313545,0.63102792,0.11323548,0.06835972,0.07582544,0.09025747,0.14322754,0.20447043,0.17303617,0.10089127,0.1186804,0.09599406,0.2115482,0.15657196,0.05269488,0.14890597],
[0.330742025,0.91647238,5.21480902,1.0196465,0.2317560,0.3823829,0.4983472,0.7742797,0.7707635,0.4492450,0.2779045,0.2498825,0.1292486,0.10746764,0.07450471,0.045625728,0.03962962,0.10981298,0.62484288,0.15371029,0.03835596,0.04629726,0.07512482,0.15971273,0.18670634,0.17994992,0.1208108,0.15121276,0.1246781,0.13403261,0.12364595,0.09094750],
[0.203667678,0.41327472,0.95823542,5.2533288,1.1708064,0.7403974,0.4067318,0.6163523,0.6377917,0.6774381,0.4136637,0.2206506,0.1243500,0.14009301,0.10223429,0.090627800,0.02440353,0.04951914,0.11481659,0.79193200,0.19377020,0.08964409,0.06131399,0.12713664,0.15449586,0.27135513,0.1798281,0.13352346,0.1199528,0.17472266,0.16966519,0.18065184],
[0.334246628,0.35191666,0.18356440,0.9867793,2.4403731,1.4053916,0.7324484,0.5358395,0.5407472,0.6473556,0.4959939,0.3529667,0.1929852,0.11730760,0.06695984,0.055097430,0.04004954,0.04216714,0.02199484,0.14875561,0.40388537,0.17015868,0.11041509,0.11052904,0.13098823,0.25930527,0.2156187,0.21359266,0.1861608,0.14630492,0.11112470,0.10982780],
[0.566924434,0.54284562,0.28713042,0.5915930,1.3323567,1.8903254,0.9841461,0.6502246,0.5897872,0.6413355,0.6698722,0.5045711,0.2824546,0.19973879,0.07630376,0.039633379,0.06792908,0.06504450,0.03440421,0.08918182,0.22050702,0.22887235,0.14835800,0.13412357,0.14286744,0.25689384,0.2912072,0.30533385,0.2724665,0.24911231,0.12663161,0.07900272],
[0.572321060,0.73873282,0.39955359,0.3469993,0.7414169,1.0508043,1.4516272,0.8931970,0.6388846,0.5006455,0.5542924,0.4429358,0.3058252,0.14354522,0.03962774,0.088090608,0.06857570,0.08851598,0.04787485,0.05230966,0.12270560,0.12722681,0.21882983,0.18424213,0.15476058,0.20053894,0.2409623,0.26803612,0.2950106,0.17902823,0.06576510,0.17559436],
[0.615553677,0.84460384,0.68028799,0.5762374,0.5943909,0.7608126,0.9788118,1.0589027,0.8317396,0.6019318,0.4968165,0.3874888,0.3354414,0.22644748,0.06024460,0.101184617,0.07375585,0.10120159,0.08151269,0.08686698,0.09837257,0.09211587,0.14755388,0.21842268,0.20147693,0.24111030,0.2159763,0.23448316,0.3235795,0.28242314,0.09998026,0.20169514],
[0.252515393,0.66164385,0.73616842,0.6482050,0.6520679,0.7501890,0.7610890,0.9041667,0.8873070,0.8411359,0.5553286,0.3907147,0.3471006,0.18525041,0.14261889,0.139546602,0.03025648,0.07927907,0.08820833,0.09771600,0.10791821,0.09082961,0.11473261,0.18650488,0.21493733,0.33692606,0.2414128,0.23643530,0.3348265,0.23104255,0.23668636,0.27816354],
[0.184448440,0.25576837,0.47040902,0.7548132,0.8558109,0.8943283,0.6538524,0.7173726,0.9221520,1.3054786,0.5912371,0.4545134,0.3223908,0.14018838,0.13792450,0.106906719,0.02210067,0.03064652,0.05636481,0.11378703,0.14163797,0.10828137,0.09856690,0.14797436,0.22337804,0.52292353,0.2570229,0.27504217,0.3109904,0.17484162,0.22889568,0.21310122],
[0.263169434,0.26955179,0.28294353,0.4481558,0.6375627,0.9082710,0.7038824,0.5757119,0.5919679,0.5748750,0.5873438,0.6907726,0.2906952,0.16631171,0.12118327,0.249819172,0.03153305,0.03229806,0.03390254,0.06755886,0.10551758,0.10996949,0.10610882,0.11875363,0.14339568,0.23027236,0.2553304,0.41801093,0.2804156,0.20742238,0.20111240,0.49797404],
[0.184652457,0.16265550,0.26420653,0.2482505,0.4711768,0.7104759,0.5841245,0.4663069,0.4325251,0.4589464,0.7173624,0.8233735,0.4604958,0.23002060,0.08620207,0.148566505,0.02212512,0.01948960,0.03165745,0.03742342,0.07798046,0.08602133,0.08805557,0.09618636,0.10477298,0.18383593,0.3118522,0.49825244,0.4442117,0.28687949,0.14305857,0.29614326],
[0.190027122,0.31348022,0.19051176,0.1950380,0.3591387,0.5544518,0.5622456,0.5627527,0.5356674,0.4538226,0.4208521,0.6419687,0.4116685,0.29157652,0.12946792,0.216110047,0.02276911,0.03756163,0.02282728,0.02940170,0.05943799,0.06713061,0.08475738,0.11608050,0.12975770,0.18178352,0.1829531,0.38847797,0.3971111,0.36365145,0.21486137,0.43078036],
[0.148068445,0.24720384,0.21821391,0.3026904,0.3007276,0.5401153,0.3635385,0.5233320,0.3938291,0.2718469,0.3316831,0.4417370,0.4016626,0.37237151,0.22243779,0.066391124,0.01774161,0.02962030,0.02614658,0.04563015,0.04977087,0.06539480,0.05480269,0.10794909,0.09539943,0.10889120,0.1441895,0.26731070,0.3874590,0.46441820,0.36915159,0.13233995],
[0.113362547,0.08941006,0.21633590,0.3158776,0.2454719,0.2950599,0.1435163,0.1990985,0.4335766,0.3824669,0.3456077,0.2367309,0.2550417,0.31808905,0.25193490,0.186374346,0.01358314,0.01071324,0.02592155,0.04761811,0.04062596,0.03572456,0.02163479,0.04106858,0.10502769,0.15320125,0.1502428,0.14325424,0.2460229,0.39671763,0.41810418,0.37150706],
[0.009216882,0.14037057,0.08840675,0.1868592,0.1347874,0.1022718,0.2128934,0.2231491,0.2830993,0.1978282,0.4754417,0.2722632,0.2840892,0.06335500,0.12437036,0.279360053,0.00110437,0.01681939,0.01059297,0.02816876,0.02230752,0.01238263,0.03209325,0.04602956,0.06857673,0.07924222,0.2066843,0.16475607,0.2740432,0.07901576,0.20640160,0.5568590]])

aging = np.zeros((32 * 32,))
aging[ 0 ] =  -0.0005479452 
aging[ 1 ] =  0.0005479452 
aging[ 33 ] =  -0.0005222729 
aging[ 34 ] =  0.0005222729 
aging[ 66 ] =  -0.0005064852 
aging[ 67 ] =  0.0005064852 
aging[ 99 ] =  -0.0004759807 
aging[ 100 ] =  0.0004759807 
aging[ 132 ] =  -0.0004011662 
aging[ 133 ] =  0.0004011662 
aging[ 165 ] =  -0.0003803185 
aging[ 166 ] =  0.0003803185 
aging[ 198 ] =  -0.0004060783 
aging[ 199 ] =  0.0004060783 
aging[ 231 ] =  -0.0004450018 
aging[ 232 ] =  0.0004450018 
aging[ 264 ] =  -0.0004837521 
aging[ 265 ] =  0.0004837521 
aging[ 297 ] =  -0.0005303459 
aging[ 298 ] =  0.0005303459 
aging[ 330 ] =  -0.0005156689 
aging[ 331 ] =  0.0005156689 
aging[ 363 ] =  -0.0005355185 
aging[ 364 ] =  0.0005355185 
aging[ 396 ] =  -0.0007465564 
aging[ 397 ] =  0.0007465564 
aging[ 429 ] =  -0.001028422 
aging[ 430 ] =  0.001028422 
aging[ 462 ] =  -0.001470658 
aging[ 463 ] =  0.001470658 
aging[ 495 ] =  -0.0009813918 
aging[ 528 ] =  -0.0005479452 
aging[ 529 ] =  0.0005479452 
aging[ 561 ] =  -0.0005222684 
aging[ 562 ] =  0.0005222684 
aging[ 594 ] =  -0.0005064831 
aging[ 595 ] =  0.0005064831 
aging[ 627 ] =  -0.0003783264 
aging[ 628 ] =  0.0003783264 
aging[ 660 ] =  -0.0002904377 
aging[ 661 ] =  0.0002904377 
aging[ 693 ] =  -0.0003763754 
aging[ 694 ] =  0.0003763754 
aging[ 726 ] =  -0.0003227668 
aging[ 727 ] =  0.0003227668 
aging[ 759 ] =  -0.0002584941 
aging[ 760 ] =  0.0002584941 
aging[ 792 ] =  -0.000239285 
aging[ 793 ] =  0.000239285 
aging[ 825 ] =  -0.0001586431 
aging[ 826 ] =  0.0001586431 
aging[ 858 ] =  -0.0001421318 
aging[ 859 ] =  0.0001421318 
aging[ 891 ] =  -0.0001060358 
aging[ 892 ] =  0.0001060358 
aging[ 924 ] =  -9.273183e-05 
aging[ 925 ] =  9.273183e-05 
aging[ 957 ] =  -9.880281e-05 
aging[ 958 ] =  9.880281e-05 
aging[ 990 ] =  -0.0001061808 
aging[ 991 ] =  0.0001061808 
aging[ 1023 ] =  -5.899185e-05
aging = aging.reshape((32, 32))

births = np.zeros((32, 32))
births[0][15] = -aging[15][15]
births[16][31] = -aging[31][31]
