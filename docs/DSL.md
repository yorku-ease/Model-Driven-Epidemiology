# Domain Specific Language

My first thoughts when we mention the use of a DSL is that in our context, its a language for defining epidemiological models, a competitor to a GUI editor.

However, in literature, it seems people compare DSLs to General Programming Languages (GPLs), this doesn't make sense to me because we don't want to create a program, like you do using a GPL, rather we want an artefact. What I mean by this is that the model is not dynamic, its static, its a graph (basically), not a tool you interact with and change, one doesn't "run" the model generated by our DSL.

If we can agree on this, then we can speak of our DSL as a Data Format, rather than a "language", it still is a language, just like HTML, XML or JSON can be called languages, but normal people call them data formats.

To put in context what I mean, imagine this pseudo code defining a model (OOP style)

```
Epidemic e("covid-19");

PopulationDimension d1("disease");
...

PopulationDimensionCompartment S("Succeptible");
PopulationDimensionCompartment E("Exposed");
PopulationDimensionCompartment I("Infected");
...

PopulationDimensionFlow S2E = Mix("S contacts I becomes E", S, I, E);
...

d1.add(S);
d1.add(E);
d1.add(S2E);
e.add(d1);
...
```

and now this pseudo code (Data Format style):
```
Epidemic "Covid-19":
  Dimension "Disease":
    Compartment S("Succeptible")
    Compartment E("Exposed")
    Compartment I("Infected")
    Mix S2E("S contacts I becomes E", S, I, E)
    ...
  ...
```

In my opinion, the second is much clearer, though I am biased AND cheated a little bit by shortening the keywords in the second version. Shortening keywords is not that unrealistic since those keywords make sense in their context, in the Programming Style approach, we are always in some kind of global scope, where the data format style only accepts some specific keywords depending on which object you are defining, so keywords can be shorter since its more clear what they mean in their context.

At this point I'm not even sure this document was necessary, but we can see about that later. The only key points are:

- We should speak of a Domain Specific Data Format (DSDF?)
- We are not trying to generate Code*
- The DSDF models data to be loaded by our programs, not programs

\* not to be confused with the actual code generation step we talked about to generate python code to train models

## As for transformations

The word "Tranformation" makes it seem like a dynamic thing, but the only 2 transformations we spoke of are the Cartesian Box Product and submodel uploading.

The cartesian box product is an implicit functionality for our project, we support dimensions and box product for all models.

### As for submodel uploading

uploading just means replacin

Let's explore replacing graph `({I}, {})` with graph `({I1, I2}, {(I1->I2)})` named `InfectiousModel`:

We could support loading models and selecting part of them to assign to compartments:

```
InfectiousModel = load("some other model path.epi")["Covid-19 infectious submodel"]["Disease"]

Epidemic "Covid-19":
  Dimension "Disease":
    Compartment S("Succeptible")
    Compartment E("Exposed")
    Compartment I("Infectious") = InfectiousModel
    Mix S2E("S contacts I becomes E", S, I, E)
    ...
  ...
```

and that submodel could be defined like so, just define it as part of a whole model for consistency so we don't even touch the syntax for model definition:

```
Epidemic "Covid-19 infectious submodel":
  Dimension "Disease":
    Compartment I1("Asymptomatic")
    Compartment I2("Symptomatic")
    Rate DiseaseEvolution("asymptomatic becomes symptomatic", I1, I2)
    ...
  ...
```

without this import mechanism, simply copying over would lead to:

```
Epidemic "Covid-19":
  Dimension "Disease":
    Compartment S("Succeptible")
    Compartment E("Exposed")
    Compartment I1("Asymptomatic")
    Compartment I2(InfectiousModel)
    Mix S2E1("S contacts I becomes E", S, I1, E)
    Mix S2E2("S contacts I becomes E", S, I2, E)
    Rate DiseaseEvolution("asymptomatic becomes symptomatic", I1, I2)
    ...
  ...
```

...or with a more complex syntax, inline the submodel instead of importing it:

```
Epidemic "Covid-19":
  Dimension "Disease":
    Compartment S("Succeptible")
    Compartment E("Exposed")
    Compartment I("Infectious"):
      Compartment I1("Asymptomatic")
      Compartment I2("Symptomatic")
      Rate DiseaseEvolution("asymptomatic becomes symptomatic", I1, I2)
    Mix S2E("S contacts I becomes E", S, I, E)
    ...
  ...
```
